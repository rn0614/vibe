# React Hooks Atomic Design ê°œë°œ ê°€ì´ë“œ

> Atomic Design ì•„í‚¤í…ì²˜ì— ë§ëŠ” React Hooks ê°œë°œ íŒ¨í„´ê³¼ ì•„í‚¤í…ì²˜ ê°€ì´ë“œ

## ğŸ—ï¸ í˜„ì¬ Hooks êµ¬ì¡° (Atomic Design + FSD)

```
front/src/
â”œâ”€â”€ hooks/         # ì»¤ìŠ¤í…€ í›…
â”‚   â”œâ”€â”€ useAuth.ts
â”‚   â”œâ”€â”€ useAuthActions.ts
â”‚   â”œâ”€â”€ useSupabaseQuery.ts
â”‚   â”œâ”€â”€ useSupabaseQueryBuilderV2.ts
â”‚   â””â”€â”€ useTheme.ts
â”œâ”€â”€ components/    # Atomic Design ì»´í¬ë„ŒíŠ¸
â”‚   â”œâ”€â”€ atoms/     # ê¸°ë³¸ UI ìš”ì†Œ
â”‚   â”œâ”€â”€ molecules/ # atoms ì¡°í•©
â”‚   â”œâ”€â”€ organisms/ # molecules ì¡°í•©
â”‚   â””â”€â”€ templates/ # í˜ì´ì§€ ë ˆì´ì•„ì›ƒ
â””â”€â”€ shared/        # ê³µìœ  ì½”ë“œ (API, Types, Utils)
```

## ğŸ§© Hook ë¶„ë¥˜ ë° ì—­í• 

### Core Hooks (ìƒíƒœ ê´€ë¦¬)
- **Router ë…ë¦½ì **: ë¼ìš°í„° ì»¨í…ìŠ¤íŠ¸ ì—†ì´ ë™ì‘
- **ì¬ì‚¬ìš© ê°€ëŠ¥**: ì—¬ëŸ¬ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì‚¬ìš©
- **ìˆœìˆ˜ í•¨ìˆ˜**: ë¶€ìˆ˜ íš¨ê³¼ ìµœì†Œí™”

**ì˜ˆì‹œ**: `useAuth`, `useTheme`, `useSupabaseQuery`

### Action Hooks (ì‚¬ìš©ì ì•¡ì…˜)
- **Router ì˜ì¡´ì **: `useNavigate`, `useLocation` ë“± ì‚¬ìš©
- **ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§**: ì‚¬ìš©ì ì•¡ì…˜ ì²˜ë¦¬
- **ìƒíƒœ ë³€ê²½**: ë°ì´í„° ìˆ˜ì • ë° ë„¤ë¹„ê²Œì´ì…˜

**ì˜ˆì‹œ**: `useAuthActions`, `useUserProfileActions`

### UI Hooks (ì»´í¬ë„ŒíŠ¸ ìƒíƒœ)
- **ì»´í¬ë„ŒíŠ¸ íŠ¹í™”**: íŠ¹ì • ì»´í¬ë„ŒíŠ¸ì—ì„œë§Œ ì‚¬ìš©
- **UI ìƒíƒœ ê´€ë¦¬**: ëª¨ë‹¬, ë“œë¡­ë‹¤ìš´, í¼ ìƒíƒœ ë“±
- **ë¡œì»¬ ìƒíƒœ**: ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ ìƒíƒœ ê´€ë¦¬

**ì˜ˆì‹œ**: `useModal`, `useDropdown`, `useForm`

## ğŸ”§ Hook ê°œë°œ íŒ¨í„´

### 1. Core Hook íŒ¨í„´ (ìƒíƒœ ê´€ë¦¬)

```typescript
// hooks/useAuth.ts
export const useAuth = () => {
  const [user, setUser] = useState<User | null>(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    // ì¸ì¦ ìƒíƒœ ì´ˆê¸°í™”
    const initAuth = async () => {
      try {
        const { data: { user } } = await supabase.auth.getUser();
        setUser(user);
      } catch (error) {
        console.error('Auth initialization failed:', error);
      } finally {
        setLoading(false);
      }
    };

    initAuth();

    // ì¸ì¦ ìƒíƒœ ë³€ê²½ êµ¬ë…
    const { data: { subscription } } = supabase.auth.onAuthStateChange(
      async (event, session) => {
        setUser(session?.user ?? null);
        setLoading(false);
      }
    );

    return () => subscription.unsubscribe();
  }, []);

  return {
    user,
    loading,
    isAuthenticated: !!user,
  };
};
```

### 2. Action Hook íŒ¨í„´ (ì‚¬ìš©ì ì•¡ì…˜)

```typescript
// hooks/useAuthActions.ts
export const useAuthActions = () => {
  const navigate = useNavigate();
  const { user } = useAuth(); // Core Hook ì‚¬ìš©

  const signInWithGoogle = async () => {
    try {
      const { error } = await supabase.auth.signInWithOAuth({
        provider: 'google',
        options: {
          redirectTo: `${window.location.origin}/auth/callback`,
        },
      });

      if (error) throw error;
    } catch (error) {
      console.error('Google sign-in failed:', error);
      throw error;
    }
  };

  const signOutWithRedirect = async (redirectTo = '/') => {
    try {
      const { error } = await supabase.auth.signOut();
      if (error) throw error;
      
      navigate(redirectTo, { replace: true });
    } catch (error) {
      console.error('Sign out failed:', error);
      throw error;
    }
  };

  return {
    user,
    signInWithGoogle,
    signOutWithRedirect,
  };
};
```

### 3. UI Hook íŒ¨í„´ (ì»´í¬ë„ŒíŠ¸ ìƒíƒœ)

```typescript
// hooks/useModal.ts
export const useModal = (initialState = false) => {
  const [isOpen, setIsOpen] = useState(initialState);

  const open = useCallback(() => setIsOpen(true), []);
  const close = useCallback(() => setIsOpen(false), []);
  const toggle = useCallback(() => setIsOpen(prev => !prev), []);

  // ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸°
  useEffect(() => {
    const handleEscape = (e: KeyboardEvent) => {
      if (e.key === 'Escape' && isOpen) {
        close();
      }
    };

    if (isOpen) {
      document.addEventListener('keydown', handleEscape);
      return () => document.removeEventListener('keydown', handleEscape);
    }
  }, [isOpen, close]);

  return {
    isOpen,
    open,
    close,
    toggle,
  };
};
```

## ğŸ¯ Atomic Design ë ˆì´ì–´ë³„ Hook íŒ¨í„´

### Atoms Hooks (ê¸°ë³¸ UI ìš”ì†Œ)
```typescript
// hooks/atoms/useButton.ts
export const useButton = (props: ButtonHookProps) => {
  const [loading, setLoading] = useState(false);
  const [disabled, setDisabled] = useState(props.disabled || false);

  const handleClick = useCallback(async (e: React.MouseEvent) => {
    if (disabled || loading) return;

    setLoading(true);
    try {
      await props.onClick?.(e);
    } finally {
      setLoading(false);
    }
  }, [props.onClick, disabled, loading]);

  return {
    loading,
    disabled,
    handleClick,
  };
};
```

### Molecules Hooks (atoms ì¡°í•©)
```typescript
// hooks/molecules/useSearchBox.ts
export const useSearchBox = (options: SearchBoxOptions) => {
  const [query, setQuery] = useState('');
  const [results, setResults] = useState<SearchResult[]>([]);
  const [loading, setLoading] = useState(false);

  const search = useCallback(async (searchQuery: string) => {
    if (!searchQuery.trim()) {
      setResults([]);
      return;
    }

    setLoading(true);
    try {
      const searchResults = await options.searchFunction(searchQuery);
      setResults(searchResults);
    } catch (error) {
      console.error('Search failed:', error);
      setResults([]);
    } finally {
      setLoading(false);
    }
  }, [options.searchFunction]);

  const handleQueryChange = useCallback((newQuery: string) => {
    setQuery(newQuery);
    search(newQuery);
  }, [search]);

  return {
    query,
    results,
    loading,
    handleQueryChange,
  };
};
```

### Organisms Hooks (molecules ì¡°í•©)
```typescript
// hooks/organisms/useUserProfile.ts
export const useUserProfile = (userId: string) => {
  const { user, loading: authLoading } = useAuth();
  const { data: profile, isLoading: profileLoading } = useQuery(
    ['user-profile', userId],
    () => fetchUserProfile(userId),
    { enabled: !!userId }
  );

  const updateMutation = useMutation(
    (data: UserUpdateDto) => updateUserProfile(userId, data),
    {
      onSuccess: () => {
        queryClient.invalidateQueries(['user-profile', userId]);
      },
    }
  );

  const deleteMutation = useMutation(
    () => deleteUserProfile(userId),
    {
      onSuccess: () => {
        // ì‚­ì œ í›„ ì²˜ë¦¬ ë¡œì§
      },
    }
  );

  return {
    profile,
    loading: authLoading || profileLoading,
    updateProfile: updateMutation.mutate,
    deleteProfile: deleteMutation.mutate,
    isUpdating: updateMutation.isLoading,
    isDeleting: deleteMutation.isLoading,
  };
};
```

### Templates Hooks (í˜ì´ì§€ ë ˆì´ì•„ì›ƒ)
```typescript
// hooks/templates/useMainLayout.ts
export const useMainLayout = () => {
  const [sidebarOpen, setSidebarOpen] = useState(false);
  const [theme, setTheme] = useTheme();

  const toggleSidebar = useCallback(() => {
    setSidebarOpen(prev => !prev);
  }, []);

  const closeSidebar = useCallback(() => {
    setSidebarOpen(false);
  }, []);

  // ë°˜ì‘í˜• ì‚¬ì´ë“œë°” ì²˜ë¦¬
  useEffect(() => {
    const handleResize = () => {
      if (window.innerWidth >= 768) {
        setSidebarOpen(false);
      }
    };

    window.addEventListener('resize', handleResize);
    return () => window.removeEventListener('resize', handleResize);
  }, []);

  return {
    sidebarOpen,
    theme,
    toggleSidebar,
    closeSidebar,
    setTheme,
  };
};
```

## ğŸ”„ Hook ì¡°í•© íŒ¨í„´

### 1. Core + Action Hook ì¡°í•©
```typescript
// hooks/useUserProfileActions.ts
export const useUserProfileActions = (userId: string) => {
  const navigate = useNavigate();
  const { profile, updateProfile, deleteProfile } = useUserProfile(userId); // Core Hook

  const updateWithRedirect = useCallback(async (data: UserUpdateDto, redirectTo = '/profile') => {
    try {
      await updateProfile(data);
      navigate(redirectTo, { replace: true });
    } catch (error) {
      console.error('Profile update failed:', error);
      throw error;
    }
  }, [updateProfile, navigate]);

  const deleteWithRedirect = useCallback(async (redirectTo = '/') => {
    try {
      await deleteProfile();
      navigate(redirectTo, { replace: true });
    } catch (error) {
      console.error('Profile deletion failed:', error);
      throw error;
    }
  }, [deleteProfile, navigate]);

  return {
    profile,
    updateWithRedirect,
    deleteWithRedirect,
  };
};
```

### 2. UI Hook ì¡°í•©
```typescript
// hooks/useFormWithValidation.ts
export const useFormWithValidation = <T extends Record<string, any>>(
  initialValues: T,
  validationSchema: ValidationSchema<T>
) => {
  const [values, setValues] = useState<T>(initialValues);
  const [errors, setErrors] = useState<Partial<Record<keyof T, string>>>({});
  const [touched, setTouched] = useState<Partial<Record<keyof T, boolean>>>({});
  const [isSubmitting, setIsSubmitting] = useState(false);

  const validate = useCallback((fieldValues: T) => {
    try {
      validationSchema.validateSync(fieldValues, { abortEarly: false });
      return {};
    } catch (validationErrors) {
      const errors: Partial<Record<keyof T, string>> = {};
      validationErrors.inner.forEach((error: any) => {
        errors[error.path as keyof T] = error.message;
      });
      return errors;
    }
  }, [validationSchema]);

  const handleChange = useCallback((name: keyof T, value: any) => {
    setValues(prev => ({ ...prev, [name]: value }));
    setTouched(prev => ({ ...prev, [name]: true }));
  }, []);

  const handleBlur = useCallback((name: keyof T) => {
    setTouched(prev => ({ ...prev, [name]: true }));
    const fieldErrors = validate({ ...values, [name]: values[name] });
    setErrors(prev => ({ ...prev, [name]: fieldErrors[name] }));
  }, [values, validate]);

  const handleSubmit = useCallback(async (onSubmit: (values: T) => Promise<void>) => {
    const validationErrors = validate(values);
    setErrors(validationErrors);

    if (Object.keys(validationErrors).length === 0) {
      setIsSubmitting(true);
      try {
        await onSubmit(values);
      } finally {
        setIsSubmitting(false);
      }
    }
  }, [values, validate]);

  return {
    values,
    errors,
    touched,
    isSubmitting,
    handleChange,
    handleBlur,
    handleSubmit,
  };
};
```

## ğŸ“‹ Hook ê°œë°œ ì²´í¬ë¦¬ìŠ¤íŠ¸

### êµ¬ì¡° ê²€ì¦
- [ ] ì˜¬ë°”ë¥¸ Hook ë¶„ë¥˜ì— ë°°ì¹˜ë˜ì—ˆëŠ”ê°€? (Core/Action/UI)
- [ ] Router ì˜ì¡´ì„±ì´ ì ì ˆíˆ ë¶„ë¦¬ë˜ì—ˆëŠ”ê°€?
- [ ] ì¬ì‚¬ìš© ê°€ëŠ¥í•˜ê²Œ ì„¤ê³„ë˜ì—ˆëŠ”ê°€?
- [ ] Atomic Design ë ˆì´ì–´ì— ë§ëŠ” Hookì¸ê°€?

### ì„±ëŠ¥ ê²€ì¦
- [ ] ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ì„ ë°©ì§€í–ˆëŠ”ê°€?
- [ ] useCallback, useMemoë¥¼ ì ì ˆíˆ ì‚¬ìš©í–ˆëŠ”ê°€?
- [ ] ì˜ì¡´ì„± ë°°ì—´ì´ ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ë˜ì—ˆëŠ”ê°€?
- [ ] ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ë¥¼ ë°©ì§€í–ˆëŠ”ê°€?

### ì—ëŸ¬ ì²˜ë¦¬
- [ ] ì—ëŸ¬ ìƒíƒœë¥¼ ì ì ˆíˆ ê´€ë¦¬í•˜ëŠ”ê°€?
- [ ] ì—ëŸ¬ ë°”ìš´ë”ë¦¬ì™€ ì—°ë™ë˜ëŠ”ê°€?
- [ ] ì‚¬ìš©ìì—ê²Œ ì ì ˆí•œ ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ì œê³µí•˜ëŠ”ê°€?

### í…ŒìŠ¤íŠ¸ ê°€ëŠ¥ì„±
- [ ] ìˆœìˆ˜ í•¨ìˆ˜ë¡œ ë¶„ë¦¬ ê°€ëŠ¥í•œê°€?
- [ ] ëª¨í‚¹í•˜ê¸° ì‰¬ìš´ êµ¬ì¡°ì¸ê°€?
- [ ] í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ì‘ì„±í•˜ê¸° ì‰¬ìš´ê°€?

## ğŸ”§ Hook ë„¤ì´ë° ì»¨ë²¤ì…˜

### Core Hooks
```typescript
// ìƒíƒœ ê´€ë¦¬ Hook
useAuth()           // ì¸ì¦ ìƒíƒœ
useTheme()          // í…Œë§ˆ ìƒíƒœ
useUser()           // ì‚¬ìš©ì ì •ë³´
useData()           // ë°ì´í„° ìƒíƒœ
```

### Action Hooks
```typescript
// ì‚¬ìš©ì ì•¡ì…˜ Hook
useAuthActions()    // ì¸ì¦ ì•¡ì…˜
useUserActions()    // ì‚¬ìš©ì ì•¡ì…˜
useFormActions()    // í¼ ì•¡ì…˜
useNavigation()     // ë„¤ë¹„ê²Œì´ì…˜ ì•¡ì…˜
```

### UI Hooks
```typescript
// UI ìƒíƒœ Hook
useModal()          // ëª¨ë‹¬ ìƒíƒœ
useDropdown()       // ë“œë¡­ë‹¤ìš´ ìƒíƒœ
useForm()           // í¼ ìƒíƒœ
useToggle()         // í† ê¸€ ìƒíƒœ
```

## ğŸ’¡ Hook ê°œë°œ Best Practices

### 1. ë‹¨ì¼ ì±…ì„ ì›ì¹™
```typescript
// âŒ ë„ˆë¬´ ë§ì€ ì±…ì„ì„ ê°€ì§„ Hook
const useUserDashboard = () => {
  // ì‚¬ìš©ì ì •ë³´, í”„ë¡œí•„, ì„¤ì •, í†µê³„ ë“± ëª¨ë“  ê²ƒì„ ê´€ë¦¬
};

// âœ… ë‹¨ì¼ ì±…ì„ì„ ê°€ì§„ Hookë“¤ë¡œ ë¶„ë¦¬
const useUser = () => { /* ì‚¬ìš©ì ì •ë³´ë§Œ */ };
const useUserProfile = () => { /* í”„ë¡œí•„ë§Œ */ };
const useUserSettings = () => { /* ì„¤ì •ë§Œ */ };
const useUserStats = () => { /* í†µê³„ë§Œ */ };
```

### 2. ì˜ì¡´ì„± ìµœì†Œí™”
```typescript
// âŒ ë„ˆë¬´ ë§ì€ ì˜ì¡´ì„±
const useUserProfile = (userId: string, includeStats: boolean, includeSettings: boolean) => {
  // ë³µì¡í•œ ì˜ì¡´ì„±ë“¤
};

// âœ… ì˜ì¡´ì„± ìµœì†Œí™”
const useUserProfile = (userId: string) => {
  // ê¸°ë³¸ í”„ë¡œí•„ ì •ë³´ë§Œ
};

const useUserProfileStats = (userId: string) => {
  // í†µê³„ ì •ë³´ë§Œ
};
```

### 3. ì—ëŸ¬ ì²˜ë¦¬ íŒ¨í„´
```typescript
// âœ… ì¼ê´€ëœ ì—ëŸ¬ ì²˜ë¦¬
const useDataWithError = <T>(fetchFn: () => Promise<T>) => {
  const [data, setData] = useState<T | null>(null);
  const [error, setError] = useState<string | null>(null);
  const [loading, setLoading] = useState(false);

  const fetchData = useCallback(async () => {
    setLoading(true);
    setError(null);
    
    try {
      const result = await fetchFn();
      setData(result);
    } catch (err) {
      setError(err instanceof Error ? err.message : 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    } finally {
      setLoading(false);
    }
  }, [fetchFn]);

  return { data, error, loading, refetch: fetchData };
};
```

### 4. ë©”ëª¨ì´ì œì´ì…˜ íŒ¨í„´
```typescript
// âœ… ì ì ˆí•œ ë©”ëª¨ì´ì œì´ì…˜
const useExpensiveCalculation = (data: ComplexData[]) => {
  const result = useMemo(() => {
    return data.reduce((acc, item) => {
      // ë³µì¡í•œ ê³„ì‚° ë¡œì§
      return acc + processItem(item);
    }, 0);
  }, [data]);

  const handleUpdate = useCallback((id: string, newValue: any) => {
    // ì—…ë°ì´íŠ¸ ë¡œì§
  }, []);

  return { result, handleUpdate };
};
```

ì´ ê°€ì´ë“œë¥¼ í†µí•´ Atomic Design ì•„í‚¤í…ì²˜ì— ë§ëŠ” ì¼ê´€ì„± ìˆê³  ì¬ì‚¬ìš© ê°€ëŠ¥í•œ React Hooksë¥¼ ê°œë°œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.